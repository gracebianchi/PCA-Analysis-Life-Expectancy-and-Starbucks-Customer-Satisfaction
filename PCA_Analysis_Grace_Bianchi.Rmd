---
title: "PCA Case Study - Life Expectancy and Starbucks Satisfaction"
author: "Grace Bianchi"
date: "2025-11-21"
output: pdf_document
---

## Load Libraries
```{r, warning = F}
library(dplyr)
library(factoextra)
library(FactoMineR)
library(corrplot)
library(ggplot2)
```

# Analysis of Life Expectancy 

### Context:

This dataset contains indicators related to global health outcomes across countries. The data describes the association between each of the 183 countries and each of the 9 health variables. PCA is applied to identify underlying dimensions of health and development by reducing the large number of correlated variables into a few principal components.

### Variable Description:

Life Expectancy: Life Expectancy in age

Adult Mortality: Adult Mortality Rates of both sexes (probability of dying between 15 and 60 years per 1000 population)

Infant Deaths: Number of Infant Deaths per 1000 population

Percentage Expenditure: Expenditure on health as a percentage of Gross Domestic Product per capita (%)

Measles: Measles - number of reported cases per 1000 population

Under-Five Deaths: Number of under-five deaths per 1000 population

Polio: Polio (Pol3) immunization coverage among 1-year-olds (%)

Diphtheria: Diphtheria tetanus toxoid and pertussis (DTP3) immunization coverage among 1-year-olds (%)

HIV/AIDS: Deaths per 1000 live births HIV/AIDS (0-4 years)

## Reading and Preparing the Data

```{r, warning = F}
#Reading the data
life_expectance_data <- read.csv("Life Expectancy Data (1).csv")

#Select data from 2015
life_expectance_data <- filter(life_expectance_data, Year == 2015)

#Keep only numeric columns
life_expectance_data <- select_if(life_expectance_data, is.numeric)

#Remove columns with NA values and Zero Variance
life_expectance_data  <- life_expectance_data  %>% select_if(~ !any(is.na(.)))
life_expectance_data <- life_expectance_data %>% select_if(~ var(.) > 0)

dim(life_expectance_data)
str(life_expectance_data)
```

## PCA Analysis and Biplots

```{r, warning=FALSE}
#Standardize data for PCA Analysis
pca_result_life <- prcomp(life_expectance_data, scale = T)

summary(pca_result_life)
```

```{r, warning=F}
#Scree plot
fviz_eig(pca_result_life, addlabels = TRUE)
```

### Figure 1.1: Scree Plot Showing Variance Explained by Each Principal Component (Life Expectancy Data)

```{r, warning = F}
#FactoMineR PCA
life.pca = PCA(life_expectance_data,scale.unit = T , ncp = 6 , graph=F)

#Biplot from FactoMineR PCA
fviz_pca_biplot(life.pca, repel = TRUE, geom = "point")
```

### Figure 1.2: PCA Biplot Displaying Relationships Among Countries and Health Variables


Interpretation: 

The first principal component explains about 38% of the total variance, the second principal component explains about 27%, and the third principal component explains about 11%. Together the three capture about 76% of the total variance, capturing most of the meaningful structure of the data. The biplot illustrates how these components structure the data: countries with high life expectancy and strong immunization coverage cluster on the negative side of PC1, while those with higher adult mortality, HIV/AIDS prevalence, and child deaths appear on the positive side. PC2 further separates countries where health challenges are concentrated in early childhood (higher measles and under-five deaths) from those with relatively lower child disease burden. PC3 introduces an orthogonal dimension tied primarily to variation in health spending (Percentage Expenditure), capturing financial differences that do not align with the main health-outcome patterns. Together, the first three componenets reveal clear groupings of countries based on overall health conditions, disease patterns, and investment in healthcare. 

## Analysis of Eigenvalues and Eigenvectors

```{r, warning = F}
#Eigenvalues table
eig_val_life = get_eigenvalue(life.pca)
eig_val_life
```

```{r, warning = F}
#Variable results: coordinates, correlations, cos2, contributions
var_life = get_pca_var(life.pca)

var_life$coord
```

Interpretation:

Based on the Kaiser criterion (eigenvalues > 1), the first three principal components were retained for interpretation, as they capture the most meaningful variance. The loadings indicate that PC1 reflects overall health outcomes. Life Expectancy, Polio, and Diphtheria load negatively, while Adult Mortality, Infant Deaths, Under-Five Deaths, and HIV/AIDS load positively. This means that higher values on PC1 represent poorer health outcomes and lower life expectancy, while lower values indicate better overall health and longer life expectancy. PC2 differentiates disease patterns by age groups. Measles, Infant Deaths, and Under-Five Deaths load positively, while Adult Mortality and HIV/AIDS show negative loadings. In other words, PC2 separates countries where health challenges are concentrated in childhood from those where disease burden is more prominent in adulthood. PC3 is driven primarily by financial variation, with Percentage Expenditure loading strongly and positive. This componenet captures differences in health-related spending across countries, separate from the broader health and disease patterns described by PC1 and PC2.

```{r, warning = F}
#Correlation Circle Plot
fviz_pca_var(life.pca, col.var = "steelblue", repel = TRUE)
```

### Figure 1.3: Correlation Circle of Variables on the First Two Principal Components


Interpretation:

The correlation circle shows that variables pointing in similar directions are positively correlated, while those on opposite sides are negatively correlated. Life Expectancy, Polio, and Diphtheria cluster together on the left, indicating that countries with higher life expectancy also tend to have higher vaccination rates. On the opposite side, Adult Mortality and HIV/AIDS point in the opposite direction, showing their strong negative relationship with those health indicators. Infant Deaths, Under-Five Deaths, and Measles cluster toward the upper right, meaning they are closely related to each other and represent another aspect of poor health conditions. Percentage Expenditure is found near the origin, showing it is not well represented on the factor map. Overall, the circle highlights two main patterns: one associated with better health outcomes and vaccination coverage, and another linked to higher mortality and disease prevalence. 

```{r, warning = F}
#Quality of representation heatmap
fviz_cos2(life.pca, choice = "var", axes = 1:2)
```

### Figure 1.4: Quality of Representation \( \cos^2 \) of Variables on PC1 and PC2

Interpretation:

The \( \cos^2 \)  (quality of representation) of each variable on the first two principal components is displayed in this plot. Variables with higher \( \cos^2 \)  values are better represented in the reduced PCA space. Infant Deaths and Under-Five Deaths have the strongest representation, followed by Measles and Life Expectancy, meaning most of their variation is captured by PC1 and PC2. In contrast, Percentage Expenditure is very weakly represented, suggesting that it contributes more to later components rather than the main health and mortality dimensions. 

```{r, warning = F}
corrplot(var_life$cos2, is.corr = FALSE)
```

### Figure 1.5: Heatmap of Variable Representation Quality \( \cos^2 \) for the First Two Principal Components


Interpretation:

This heatmap shows the \( \cos^2 \)  values across all principal components, showing how each variable is represented by each dimension. Life Expectancy, Adult Mortality, HIV/AIDS, and immunization indicators (Polio and Diphtheria) are captured mainly by the first component, which represents general health outcomes. Infant Deaths, Under-Five Deaths, and Measles are associated with both the first and second components, indicating a related but distinct dimension of child mortality and disease burden. Percentage Expenditure is almost entirely captured by the third component, reflecting differences in healthcare spending. Overall, the first two dimensions summarize health and mortality patterns, while the third captures financial variation across countries

```{r, warning = F}
#Top contributing variables to PC1 
fviz_contrib(life.pca, choice = "var", axes = 1, top = 10)
```

### Figure 1.6: Top Variable Contributions to the First Principal Component (PC1)

```{r, warning = F}
#Top contributing variables to PC2
fviz_contrib(life.pca, choice = "var", axes = 2, top = 10)
```

### Figure 1.7: Top Variable Contributions to the Second Principal Component (PC2)


```{r, warning = F}
#Top contributing variables to PC3
fviz_contrib(life.pca, choice = "var", axes = 3, top = 10)
```

### Figure 1.8: Top Variable Contributions to the Third Principal Component (PC3)

Interpretation:

The contribution plots show that Life Expectancy and Adult Mortality contribute the most to PC1, making them the main variables driving this overall health dimension. The remaining mortality and disease indicators contribute at fairly similar levels, while Percentage Expenditure contributes very little. For the second component, Measles, Infant Deaths, and Under-Five Deaths stand out as the main contributors, suggesting that PC2 captures variation related to childhood disease and early-life outcomes. For the third componenet, Percentage Expenditure stands out as the main contributor, suggesting that PC3 captures variation related to financial variation across countries. 

## Conclusion

Overall, the PCA shows that life expectancy differences across countries in 2015 can be largely explained by a small group of strongly correlated health indicators. The first three components account for about 76% of the total variation: PC1 captures a broad health and development dimension, PC2 reflects variation in child mortality and infectious disease, and PC3 represents financial differences in health spending. Countries with higher life expectancy and stronger vaccination coverage tend to score lower on PC1, while those with higher HIV/AIDS prevalence, infant deaths, and overall mortality score higher. These components together highlight how a few key variables can summarize the major global patterns in population health.

## Discussion of PCA Assumptions and Limitations

PCA assumes linear relationships among variables and that the components explaining the most variance are the most meaningful. Since all variables were standardized, each contributed equally to the analysis, regardless of their original scales of measurement units. However, PCA is sensitive to outliers and depends heavily on the correlation structure of the data, meaning that highly correlated variables can dominate the results. In the context of the life expectancy data, this is especially relevant because many health indicators, such as mortality rates, tend to move together. Despite these limitations, PCA still proved useful for reducing dimensionality and uncovering clear, interpretable patterns in global health outcomes. 

# Analysis of Starbucks Customer Satisfaction: Using First Dataset Provided

### Context:

This dataset contains survey responses from 113 customers regarding their purchasing behavior at Starbucks. It includes 20 variables measuring satisfaction, demographics, spending patterns, and interaction preferences. PCA is applied to identify the underlying dimensions that structure these responses, revealing the latent factors that shape overall customer satisfaction and loyalty.

```{r, warning = F}
#Reading the data
starbucks_data <- read.csv("Starbucks satisfactory survey encode cleaned (1).csv")

#Keep only numeric columns
starbucks_data <- select_if(starbucks_data, is.numeric)

#Remove columns with NA values and Zero Variance
starbucks_data  <- starbucks_data  %>% select_if(~ !any(is.na(.)))
starbucks_data <- starbucks_data %>% select_if(~ var(.) > 0)

dim(starbucks_data)
str(starbucks_data)
```

## PCA and Biplots

```{r, warning = F}
#PCA Analysis 
pca_result_starbucks <- prcomp(starbucks_data, scale = T)

summary(pca_result_starbucks)
```

```{r, warning = F}
#Scree Plot
fviz_eig(pca_result_starbucks, addlabels = TRUE)
```

### Figure 2.1: Scree Plot Showing Variance Explained by Each Principal Component (Starbucks Data)

```{r, warning = F}
#FactoMineR PCA
starbucks.pca = PCA(starbucks_data,scale.unit = T , ncp = 6 , graph=F)

#Biplot from FactoMineR PCA
fviz_pca_biplot(starbucks.pca, repel = TRUE, geom = "point")
```

### Figure 2.2: PCA Biplot Showing Relationships Among Satisfaction Dimensions


Interpretation: 

From the scree plot, the first three components explain about 42% of the total variance (~19%, ~14%, and ~9% respectively). While a full analysis would retain the first six components (which together account for about 61% of the variance), the first three are sufficient for summarizing the main structure in the data. PC1 reflects overall customer satisfaction: serviceRate, chooseRate, ambianceRate, productRate, and priceRate all load strongly and positively, indicating that customers tend to rate these aspects together. PC2 contrasts demographic and behavioral factors. Income, Age, and spendPurchase load negatively, while wifiRate loads positively, separating customers with higher spending and income from those whose satisfaction depends more on store amenities. PC3 captures contextual and lifestyle-related variation, driven mainly by variables such as Status, Method, and Location. These factors do not measure satisfaction directly but instead reflect differences in customers’ employment context, how far they travel to the store, and their preferred purchasing method. This component represents situational patterns in how customers engage with Starbucks, which operate independently from the main satisfaction dimensions captured by PC1 and PC2.

## Analysis of Eigenvalues and Eigenvectors

```{r, warning = F}
#Eigenvalues table
eig_val_starbucks = get_eigenvalue(starbucks.pca)
eig_val_starbucks
```

```{r, warning = F}
#Variable results: coordinates, correlations, cos2, contributions
var_starbucks = get_pca_var(starbucks.pca)

var_starbucks$coord
```

Interpretation: 

Based on the Kaiser criterion (eigenvalues > 1), the first six principal components should be retained, but for interpretability the first three are examined. The loadings indicate that PC1 reflects overall customer satisfaction, with productRate, serviceRate, ambianceRate, chooseRate, and priceRate all loading strongly and positively. This means higher PC1 values correspond to customers who rate the Starbucks experience more favorably across multiple dimensions. PC2 captures demographic and behavioral variation, with income, age, and spendPurchase loading negatively, while wifiRate loads positively. In other words, PC2 separates higher-income or higher-spending customers from those whose evaluations are more influenced by amenities. PC3 is shaped by variables such as status, method, and location, representing differences in customers’ circumstances and store-use patterns rather than differences in satisfaction. Together, the first three components summarize the main patterns underlying customer ratings and behaviors.


```{r, warning = F}
#Correlation Circle Plot
fviz_pca_var(starbucks.pca, col.var = "steelblue", repel = TRUE)
```

### Figure 2.3: Correlation Circle of Customer Satisfaction Variables on PC1 and PC2


Interpretation:

The correlation circle shows that variables pointing in similar directions are positively correlated, while those pointing in opposite or far-separated directions are negatively or weakly related. ServiceRate, ambianceRate, productRate, priceRate, and chooseRate cluster tightly together on the right, indicating that they capture a common satisfaction dimension. Income, age, and spendPurchase form a separate grouping oriented roughly 90 degrees away, suggesting that demographic and spending behavior vary largely independently from satisfaction ratings. Variables such as status, method, and location appear near the center of the plot, indicating weak associations with PC1 and PC2—consistent with their stronger contributions to PC3. This suggests that PC3 represents an additional organizational or behavioral dimension that is not well captured in the first two components. Overall, the circle highlights two main patterns in the data: one driven by customer satisfaction ratings and another shaped by demographic and spending behavior, with a third subtler pattern emerging from membership and usage characteristics.

```{r, warning = F}
#Quality of representation heatmap
fviz_cos2(starbucks.pca, choice = "var", axes = 1:2)
```

### Figure 2.4: Quality of Representation \( \cos^2 \) of Variables on PC1 and PC2 

Interpretation:

The \( \cos^2 \) (quality of representation) of each variable on the first two principal components is displayed in this plot. Variables with higher \( \cos^2 \) are better represented in the reduced PCA space. AmbianceRate and serviceRate have the strongest representation, followed by income, productRate, and wifiRate, meaning most of their variation is captured by PC1 and PC2. In contrast, status, location, and method are very weakly represented, suggesting that they contribute more to later components rather than the main customer satisfaction and behavior dimensions. 

```{r, warning = F}
corrplot(var_starbucks$cos2, is.corr = FALSE)
```

### Figure 2.5: Heatmap of Variable Representation Quality \( \cos^2 \) for the First Two Principal Components

Interpretation:

The heatmap shows the \( \cos^2 \) values across all principal components, showing how each variable is represented by each dimension. ProductRate, priceRate, ambianceRate, serviceRate, and chooseRate are captured mainly by the first component, reflecting a shared customer satisfaction dimension. Income, spendPurchase, age, and wifiRate are mainly captured by the second components, indicating a demographic and spending-behavior dimension. Finally, status, location, and method show their strongest representation on the third component, indicating a separate contextual dimension related to customers’ circumstances and store-use patterns.


```{r, warning = F}
#Top contributing variables to PC1
fviz_contrib(starbucks.pca, choice = "var", axes = 1, top = 10)
```

### Figure 2.6: Top Variable Contributions to the First Principal Component (PC1)

```{r, warning = F}
#Top contributing variables to PC2
fviz_contrib(starbucks.pca, choice = "var", axes = 2, top = 10)
```

### Figure 2.7: Top Variable Contributions to the Second Principal Component (PC2)

```{r, warning = F}
#Top contributing variables to PC2
fviz_contrib(starbucks.pca, choice = "var", axes = 3, top = 10)
```

### Figure 2.8: Top Variable Contributions to the Third Principal Component (PC3)

Interpretation:

The contribution plots show that productRate, chooseRate, ambianceRate, priceRate, and serviceRate contribute most strongly to the first principal component, confirming that PC1 represents overall customer satisfaction and the core in-store experience. PC2 is driven mainly by income, wifiRate, spendPurchase, and age, indicating that it captures demographic and spending-related variation rather than satisfaction itself. PC3 is dominated by Method, Status, and Location, reflecting a third dimension related to customers’ circumstances and store-use patterns rather than their satisfaction ratings. Together, these components show that PCA separates satisfaction, demographics/behavior, and engagement patterns into three distinct sources of variation in the Starbucks dataset.

## Conclusion

The Starbucks PCA results show that customer satisfaction is shaped by multiple overlapping dimensions rather than a single factor. The first three principal components together capture the most meaningful structure in the data. PC1 reflects overall satisfaction, driven by ratings of service, product quality, ambiance, price, and choice. PC2 captures demographic and spending-related variation, distinguishing higher-income or higher-spending customers from those more influenced by amenities. PC3 reflects customer circumstances and store-use patterns, including ordering method, distance from the store, and employment status. Overall, the analysis suggests that while the in-store experience is the strongest driver of satisfaction, demographic differences and engagement behaviors also meaningfully shape how customers evaluate their Starbucks visits.

## Discussion of PCA Assumptions and Limitations

PCA assumes that relationships among variables are linear and that the components explaining the greatest variance are the most meaningful. Because all variables were standardized, each contributed equally to the analysis, regardless of its original scale. However, the method is sensitive to outliers and assumes that the underlying relationships are continuous and additive, which may not fully capture the complexity of customer preferences. Despite these limitations, PCA effectively reduced dimensionality and revealed clear, interpretable patterns in customer satisfaction and behavior.